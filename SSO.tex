\documentclass[12pt, a4paper]{article}
\setlength{\headheight}{20pt}
%\renewcommand{\baselinestretch}{1.5}
\usepackage[margin=3cm]{geometry}
\usepackage{setspace}
%\onehalfspacing
\setstretch{1.2}
%\usepackage{mathptmx}% Times Roman font
%\usepackage{utopia}
%\usepackage{newcomputermodern}
\usepackage{lmodern}
\usepackage{varwidth}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mdframed}
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}
\usepackage{pgfplots}
\usepackage{csquotes}
\usepackage{footnote}
\newcommand\s{30} %samples i grafer. set til 1000, 80 for arbejde
%\newcommand{\doubleunderline}{\underline{\underline{}}}
\usepackage{lipsum}
\usepackage{blindtext}
%flyta myndir
\usepackage{graphicx}
\usepackage{float}
\usepackage{sidecap}
%flyta myndir end
\fboxrule=1pt
\fboxsep=4pt
\usepackage{titlesec}
\titleformat{\section}
{\LARGE \bfseries}
{\thesection}
{1em}
{}

\titleformat{\subsection}
{\large \bfseries}
{\thesubsection}
{0.5em}
{}

%bruka inkscapefílir
\usepackage{import}
\usepackage{xifthen}
\usepackage{pdfpages}
\usepackage{transparent}

\newcommand{\incfig}[1]{%
    \def\svgwidth{6.00cm}
    \import{./figures/}{#1.pdf_tex}
}
\renewcommand*\contentsname{Indholdsfortegnelse}
\renewcommand{\figurename}{Figur}
%bruka inkscapefílir end

\makeatletter
\patchcmd{\csq@bquote@i}{{#6}}{{\emph{#6}}}{}{}
\makeatother



%\usepackage[backend=biber,sorting=nty,style=verbose]{biblatex}
\usepackage[backend=biber,sorting=nty, style=authoryear-ibid]{biblatex}
\addbibresource{bibliografi.bib} %Imports bibliography file
\DeclarePrintbibliographyDefaults{heading=none}
\title{Taylorpolynomier}
%\author{Jákup H. Lützen}
\date{Februar 2022}
%\pagestyle{fancy}
%\fancyhead{}
%\fancyfoot{}
\begin{document}
\begin{refsection}
\begin{titlepage}
   \centering
    \vfill
%    \maketitle
    {\huge 
    Taylorpolynomier\\
    \vspace{0.5cm}
    \large
    SSO - Matematik A\\
    \vspace{0.25cm}
    Februar 2022
    }    
    \vfill
%    \includegraphics[width=\textwidth]{figures/forside3edit2.png} % also works with logo.pdf
   
    \includegraphics[width=\textwidth]{figures/forside4edit.png} % also works with logo.pdf
    \vfill
    \vfill
\thispagestyle{empty}

\end{titlepage}
%%%%% \footnote{hey} fyri vanligan footnote
%%%%%\footcite{talogrækker} fyri referencu
%%%%% :set spell spelllang=da (fyri at byrja spellcheck)
%%%% :set nospell fyri at sløkkja
%\setcounter{page}{2} % Set dette hvis første side tæller med i sidecount 
\section*{Resume} %150 ord (det essentielle i min opgave, dvs ca 8 linjer
\blindtext[1-2]
\tableofcontents
\newpage



\section{Indledning} %ca en halv side til en side. I egne ord, hvorfor dette er interessant. God ide at slutte af med problemformuleringen, "Og her vil jeg..."
Matematik kan til tider synes firkantet og rigidt, hvor abstrakte forhold opskrives i eksakte formler, og hvor der ikke er plads til kreativitet. 
Dykker man dybere ind i faget vil man dog opdage, at dette ikke er tilfældet, og at der er mange situationer, hvor man gør kreativt brug af relativt ueksakte værktøjer. Et af disse er såkaldte Taylorpolynomier.


I matematikkens verden findes der alverdens slags funktioner, hvor nogle er mere medgørlige end andre. Nutidens computerteknik kræver desuden hurtig og praktisk behandling af alle disse formler, og i den forbindelse indtræder Taylorpolynomier ofte.\\
\\
Taylorpolynomier er ingen ny opfindelse. De dukkede for første gang op i 17-18. århundrede, men hvordan blev de opdaget? Der er ingen tvivl om at de har haft stor indflydelse på måden som matematik bliver behandlet i dag, men hvordan ved man om de er korrekte, i hvilken grad ved man det, og hvorfor er det i det hele taget relevant i dag?\\
\\
Denne opgave vil beskrive den historiske baggrund for Taylorrækken, bevise formlen for Taylorrækken, undersøge dens restled, samt undersøge hvilke praktiske anvendelser Taylorpolynomier har i dag.

\section{Taylorrækkens historie} % Redegørelse Egne ord. Ikke inddrage citater (fordi så bliver det analyserende).
Matematikeren Brook Taylor (1685 - 1731) er navnefader til hvad vi i dag kalder Taylorpolynomier, efter at han i 1715 offentliggjorde en generel formel, der for samtidens matematikere var kendt som Proposition 7, Corollary 2 fra hans \textit{Methodus}.
Taylors formel ser således ud i sin moderne form:\footcite[s. 247]{roy_2021}$^,$\footcite[s. 72]{feigenbaum_exact_sciences}
\begin{equation*}
   f(x)=f(a)+f(x-a)\frac{f'(a)}{1!}+(x-a)^2\frac{f''(a)}{2!}+\cdots. 
\end{equation*}
Dette kan naturligvis også skrives som:
\begin{equation*}
    f(x)=\sum_{n=0}^{\infty}\frac{f^{(n)}(a)}{n!}(x-a)^n.
\end{equation*}
Men Taylor var dog ikke den første der tænkte disse tanker. Man ved i dag, at der var mindst fem andre forløbere: James Gregory, Newton, Leibniz, Johann I. Bernoulli, og Abraham De Movre.\footcite{feigenbaum_exact_sciences}
\subsection{Newton, Gregory og Bernoulli}

Taylorpolynomier bygger på en indseelse, at der er en forbindelse mellem en funktions koefficienter og dens afledte. Denne indseelse viser Isaac Newton (1643 - 1727) for første gang i hans \textit{Principia} (1687), og få år senere giver han et egentligt eksempel af Taylors formel i sin \textit{De Quadratura Curvarum} (1691 - 92), som han aldrig færdiggjorde. Dele af denne tekst blev udgivet med titlen \textit{Tractatus de Quadratura Curvarum}, men Taylors formel blev desværre udladt.\footcite[s. 248]{roy_2021} Newton havde altså opdaget disse samme principper femogtyve år tidligere end Taylor, uden at de blev udgivet.\\
\\
Newton havde i det hele taget svært ved at udgive sine findelser før han blev kendt i videre kredse, hvilket til tider voldte ham problemer i at blive anerkendt for sine opdageser. \footcite[s. 116]{uendeligerækker}\\
En af konsekvenserne af dette var den kendte kontroversi imellem Newton og Gottfried Wilhelb Leibniz (1646 - 1716), da de ifølge Mejlbo:
\blockquote{blev indviklede i en ulykkelig strid om ophavsretten til differential- og integralregningen. Den gik værst  ud over Leibniz. Royal Society dømte ham - ganske uberettiget - for plagiat}.\footcite[s. 103]{uendeligerækker}\\
En af Leibnitz' største fortalere i denne prioritetsstrid var Johann Bernoulli (1667 - 1748), som i slutningen af 1690'erne også havde udgivet en formel der lignede Taylors formel. Mejlbo skriver om Bernoulli at: \blockquote{\dots han havde et voldsomt temperament, så han overfusede Taylor med beskyldninger for plagiat.}\footcite[s. 111]{uendeligerækker}. \textcolor{red}{mere om Bernoulli og Taylors rivalisering}\\
\\
Den tidligste opdager af Taylors formel var dog nok den Skotske matematiker James Gregory (1638 – 1675).\\
\textcolor{red}{\textbf{Mere om Gregory}} 
\newpage
\section{Analyse} % Kød og kartofler. Brug modellen (introducere citatet, så kommer citatet, og så kommenterer man.
\subsection{Pædagogisk gennemgang (\textcolor{red}{arbejdstitel})}
Man kan opnå en simpel intuitiv forståelse for Taylorpolynomier med følgende fremgangsmåde:\\
Man ønsker at approksimere en given funktion $f(x)$ fra x-værdien $x_0$. I dette eksempel bruges funktionen $f(x)=e^x$, og $x_0=1$.\\
\begin{figure}[h!]
     \includegraphics[width=\textwidth]{figures/ex-eksempel.png}
     \caption{Nulte- første- og andengrads Taylorpolynomium for $e^x$}
     \label{fig:boat1}
\end{figure}\\
Den simpleste approksimation kunne være en konstant funktion, som deler værdi med $f(x)$ på $x_0$ (\textit{Figur 1, grøn}).
\[
f(1)=e
.\] 
Dette er funktionens nultegrads Taylorpolynomium, som er en meget grov approksimation, da den er konstant. Den kan dog forbedres ved at tilføje den korrekte hældning på punktet. Dette genkendes som ligningen for tangenten til grafen for $f$ i $P\big(x_0,f(x_0)\big)$.\footcite[s. 24, frml. 130]{formelsamling}
\[
\begin{aligned}
    y&=f'(x_0) \cdot (x-x_0)+f(x_0)\\
    \Updownarrow\quad &=f(x_0)+f'(x_0) \cdot (x-x_0)
\end{aligned}
.\] 
Den gældende funktion indsættes, og hermed findes funktionens førstegrads Taylorpolynomium  (\textit{Figur 1, blå}).\\
\[
\begin{aligned}
    y&=e+e\cdot (x-1)
\end{aligned}
.\] 
Nu er værdien samt hældningen på $x_0$ korrekt. For at forbedre approksimationen kan man tilføje den korrekte krumning. 
\subsection{Bevis for Taylorpolynomiet}
Vi har indtil videre set, hvordan en tangent og en parabel blev brugt som en polynomisk approksimation for en funktion $f(x)$. Vi kan generalisere denne approksimationsmetode tæt på $x=x_0$ med et  $n$-tegrads polynomium.\\
\[
P_n(x)=c_0+c_1x+c_2x^2+ \cdots +c_nx^n
\] 
således at polynomiets værdi på $x_0$ stemmer overens med  $f(x_0)$. Det samme skal gælde for alle afledte, op til $n$ gange afledte funktioner, dvs:
 \begin{equation}\label{deafledtestemmer}
     \begin{aligned}
         P_n(x_0)&=f(x_0),\\
         P'_n(x_0)&=f'(x_0),\\
         P''_n(x_0)&=f'(x_0),\\
                   &\vdots\\
         P^{(n)}_n(x_0)&=f^{(n)}(x_0).
     \end{aligned}
\end{equation}
Eftersom det er $x_0$ vi har interesse i, giver det mening at udtrykke  $P_n$ på formen:
\begin{equation}\label{nybevis1}
   P_n(x)=c_0+c_1(x-x_0)+c_2(x-x_0)^2+\cdots+c_n(x-x_0)^n 
\end{equation}
For at finde konstanterne $c_0, c_1 \cdots c_n$ på punktet $x_0$, kan vi ganske enkelt indsætte $x=x_0$ i $P_n(x), P'_n(x) \cdots P^{(n)}_n(x)$. Vi bruger desuden ligning (\ref{deafledtestemmer}) at forbinde konstanterne med $f(x_0)$\\
%Når dette sættes ind i ligning (\ref{deafledtestemmer}), giver det:
Den første konstant er åbenlys, når vi indsætter $x=x_0$ i ligning (\ref{nybevis1})
 \begin{equation*}
    c_0=P_n(x_0)=f(x_0)
\end{equation*}
Derefter observerer vi den afledte funktion: 
\begin{equation}\label{førsteafledte}
        P'_n(x)=c_1+2c_2(x-x_0)+3c_3(x-x_0)^2+\cdots+nc_n(x-x_0)^{n-1}\\
\end{equation}
Vi kan nu på samme måde indsætte $x=x_0$ i ligning (\ref{førsteafledte}), og igen jævnføre med ligning (\ref{deafledtestemmer}), for at konkludere at:
\begin{equation*}
    c_1=P'_n(x_0)=f'(x_0)
\end{equation*}
Vi fortsætter samme fremgangsmåde, og observerer nu $P''_n(x)$.
\begin{equation}\label{andenafledte}
    P''_n(x)=2c_2+ 3\cdot2c_3(x-x_0)+\cdots+n(n-1)c_n(x-x_0)^{n-2}
\end{equation}
Når vi indsætter $x=x_0$ i ligning (\ref{andenafledte}) sær vi at $2c_2 = P''_n(x_0)=f''(x_0)$, hvilket betyder at:
\begin{equation*}
    c_2=\frac{1}{2}f''(x_0).
\end{equation*}
Nu begynder et mønster at vise sig.


\subsubsection{Sætning 1}
Vi skal bevise at det $n $'te Taylorpolynomium $P_n$ med udviklingspunkt $a$ er givet ved:
\begin{equation*}
    \begin{aligned}
        P_n= &f(a)+f'(a)(x-a)+\frac{1}{2}f''(a)(x-a)^2\\
             &+\frac{1}{3}f'''(a)(x-a)^3+\cdots+\frac{1}{n!}f^{(n)}(a)(x-a)^n
    \end{aligned}
\end{equation*}
\subsubsection{Bevis.}
Ethvert polynomium $P_n$ af højst $n$-te grad kan skrives således:
 \begin{equation}\label{bevis1}
    P_n(x)=a_0+a_1(x-a)+a_2(x-a)^2+a_3(x-a)^3+\cdots+a_n(x-a)^n
\end{equation}
Hvis man indsætter $x=a$ i ligning (\ref{bevis1})

Der findes mange beviser for Taylors formel, men ingen af dem er helt ligefrem. De benytter altid et trick for at begynde beviset \footcite[A-44]{calculuswithanalyticgeometry}. I dette bevis begynder man med at introducere en hjælpefunktion $F(x)$ således at:
\begin{equation}\label{bevisrest1}
 \begin{aligned}
     F(x)&=f(b)-f(x)-f(x)(b-x)-\frac{f''(x)}{2!}(b-x)^2\\
         &- \cdots -\frac{f^{(n)}(x)}{n!}(b-x)^n-K(b-x)^{n-1}.
\end{aligned}
\end{equation}

\begin{savenotes}
\noindent%
\begin{minipage}{0.6\textwidth}
Konstanten $K$ vælges således at $f(a)=0$. Dette kan gøres eksplicit, ved at indsætte $x=a$ på højre side, og $F(x)=F(a)=0$ på venstre side af ligning (\ref{bevisrest1}), siden løse for $K$, men dette er ikke nødvendigt.\\
Når man indsætter $x=b$ i ligning (\ref{bevisrest1}), er det tydeligt at  $F(b)=0$.\\
Dette betyder at \textit{Rolles sætning}\footcite[s. 210]{calculuswithanalyticgeometry} gælder, således at:
\end{minipage}
\begin{minipage}{0.4\textwidth}
\begin{center}
\fbox{
 \begin{varwidth}{0.7\textwidth}   
     \begin{footnotesize}
        \begin{center} 
 \textbf{Rolles sætning:}\newline
 Antag at $f$ er kontinuert og differentiabel i $[a,b]$. Hvis $f(a)=0=f(b)$, så findes der et tal $c$ i $(a,b)$ således at $f'(c)=0$.
 \end{center}
     \end{footnotesize}
\end{varwidth}}
\end{center}
\end{minipage}
\end{savenotes}



\begin{equation}\label{bevisrest2}
    F'(z)=0,
\end{equation}
for en værdi af $z$ hvor $(a<z<b)$.\\
Hvis man differentierer ligning (\ref{bevisrest1}), får man:
\begin{equation*}
    \begin{aligned}
        F'(x) &=(0) -f'(x)+f'(x)-f''(x)(b-x)\\
              &+f''(x)(b-x)-\frac{1}{2!}f^{(3)}(x)(b-x)^2\\
              &+\frac{1}{2!}f^{(3)}(x)(b-x)^2-\frac{1}{3!}f^{(4)}(x)(b-x)^3\\
              &+\cdots + \frac{1}{(n-1)!}f^{(n)}(x)(b-x)^{n-1}-\frac{1}{n!}f^{(n+1)}(x)(b-x)^n\\
              &+(n+1)K(b-x)^n
    \end{aligned}
\end{equation*}
Ved tæt inspektion kan man indse, at alle led, pånær de sidste to, går ud med hinanden. Dette kollapser altså til:
\begin{equation}\label{bevisrest3}
    F'(x)=(n+1)K(b-x)^n-\frac{f^{(n+1)}(x)}{n!}(b-x)^n.
\end{equation}
Derfor følger, at når man indsætter ligning (\ref{bevisrest3}) i ligning (\ref{bevisrest2}), får man:
---
\section{Diskussion/Vurdering} % Måske tage nogle fagpersoner med eller noget. Gerne selv tage stilling.
\section{Konklusion} % samle problemformuleringens underspørgsmål. "jeg har. og så... jeg kan konkludere..."
\newpage
\section{Litteraturliste}
\subsection{Referenceliste}
\printbibliography[title=Cited]
\end{refsection}
\subsection{Litteraturliste}
\nocite{*}
\printbibliography
%\printbibliography[keyword=online]
Forsidebillede samt alle figurer er skabt af undertegnede.
\end{document}

